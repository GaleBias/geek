<audio title="46 _ 访问网络服务" src="https://static001.geekbang.org/resource/audio/a9/fb/a95b0a665b0f5a780748aca96012adfb.mp3" controls="controls"></audio> 
<p>你真的很棒，已经跟着我一起从最开始初识Go语言，一步一步地走到了这里。</p><p>在这之前的几十篇文章中，我向你一点一点地介绍了很多Go语言的核心知识，以及一些最最基础的标准库代码包。我想，你已经完全有能力独立去做一些事情了。</p><p>为了激发你更多的兴趣，我还打算用几篇文章来说说Go语言的网络编程。不过，关于网络编程这个事情，恐怕早已庞大到用一两本专著都无法对它进行完整论述的地步了。</p><p>所以，我在这里说的东西只能算是个引子。只要这样能让你产生想去尝试的冲动，我就很开心了。</p><h2>前导内容：socket与IPC</h2><p>人们常常会使用Go语言去编写网络程序（当然了，这方面也是Go语言最为擅长的事情）。说到网络编程，我们就不得不提及socket。</p><p>socket，常被翻译为套接字，它应该算是网络编程世界中最为核心的知识之一了。关于socket，我们可以讨论的东西太多了，因此，我在这里只围绕着Go语言向你介绍一些关于它的基础知识。</p><p>所谓socket，是一种IPC方法。IPC是Inter-Process Communication的缩写，可以被翻译为进程间通信。顾名思义，IPC这个概念（或者说规范）主要定义的是多个进程之间，相互通信的方法。</p><p>这些方法主要包括：系统信号（signal）、管道（pipe）、套接字 （socket）、文件锁（file lock）、消息队列（message queue）、信号灯（semaphore，有的地方也称之为信号量）等。现存的主流操作系统大都对IPC提供了强有力的支持，尤其是socket。</p><!-- [[[read_end]]] --><p>你可能已经知道，Go语言对IPC也提供了一定的支持。</p><p>比如，在<code>os</code>代码包和<code>os/signal</code>代码包中就有针对系统信号的API。</p><p>又比如，<code>os.Pipe</code>函数可以创建命名管道，而<code>os/exec</code>代码包则对另一类管道（匿名管道）提供了支持。对于socket，Go语言与之相应的程序实体都在其标准库的<code>net</code>代码包中。</p><p><strong>毫不夸张地说，在众多的IPC方法中，socket是最为通用和灵活的一种。</strong>与其他的IPC方法不同，利用socket进行通信的进程，可以不局限在同一台计算机当中。</p><p>实际上，通信的双方无论存在于世界上的哪个角落，只要能够通过计算机的网卡端口以及网络进行互联，就可以使用socket。</p><p>支持socket的操作系统一般都会对外提供一套API。<strong>跑在它们之上的应用程序利用这套API，就可以与互联网上的另一台计算机中的程序、同一台计算机中的其他程序，甚至同一个程序中的其他线程进行通信。</strong></p><p>例如，在Linux操作系统中，用于创建socket实例的API，就是由一个名为<code>socket</code>的系统调用代表的。这个系统调用是Linux内核的一部分。</p><blockquote>
<p><span class="reference">所谓的系统调用，你可以理解为特殊的C语言函数。它们是连接应用程序和操作系统内核的桥梁，也是应用程序使用操作系统功能的唯一渠道。</span></p>
</blockquote><p>在Go语言标准库的<code>syscall</code>代码包中，有一个与这个<code>socket</code>系统调用相对应的函数。这两者的函数签名是基本一致的，它们都会接受三个<code>int</code>类型的参数，并会返回一个可以代表文件描述符的结果。</p><p>但不同的是，<code>syscall</code>包中的<code>Socket</code>函数本身是平台不相关的。在其底层，Go语言为它支持的每个操作系统都做了适配，这才使得这个函数无论在哪个平台上，总是有效的。</p><p>Go语言的<code>net</code>代码包中的很多程序实体，都会直接或间接地使用到<code>syscall.Socket</code>函数。</p><p>比如，我们在调用<code>net.Dial</code>函数的时候，会为它的两个参数设定值。其中的第一个参数名为<code>network</code>，它决定着Go程序在底层会创建什么样的socket实例，并使用什么样的协议与其他程序通信。</p><p>下面，我们就通过一个简单的问题来看看怎样正确地调用<code>net.Dial</code>函数。</p><p><strong>今天的问题是：<code>net.Dial</code>函数的第一个参数<code>network</code>有哪些可选值？</strong></p><p>这道题的<strong>典型回答</strong>是这样的。</p><p><code>net.Dial</code>函数会接受两个参数，分别名为<code>network</code>和<code>address</code>，都是<code>string</code>类型的。</p><p>参数<code>network</code>常用的可选值一共有9个。这些值分别代表了程序底层创建的socket实例可使用的不同通信协议，罗列如下。</p><ul>
<li><code>"tcp"</code>：代表TCP协议，其基于的IP协议的版本根据参数<code>address</code>的值自适应。</li>
<li><code>"tcp4"</code>：代表基于IP协议第四版的TCP协议。</li>
<li><code>"tcp6"</code>：代表基于IP协议第六版的TCP协议。</li>
<li><code>"udp"</code>：代表UDP协议，其基于的IP协议的版本根据参数<code>address</code>的值自适应。</li>
<li><code>"udp4"</code>：代表基于IP协议第四版的UDP协议。</li>
<li><code>"udp6"</code>：代表基于IP协议第六版的UDP协议。</li>
<li><code>"unix"</code>：代表Unix通信域下的一种内部socket协议，以SOCK_STREAM为socket类型。</li>
<li><code>"unixgram"</code>：代表Unix通信域下的一种内部socket协议，以SOCK_DGRAM为socket类型。</li>
<li><code>"unixpacket"</code>：代表Unix通信域下的一种内部socket协议，以SOCK_SEQPACKET为socket类型。</li>
</ul><h2>问题解析</h2><p>为了更好地理解这些可选值的深层含义，我们需要了解一下<code>syscall.Socket</code>函数接受的那三个参数。</p><p>我在前面说了，这个函数接受的三个参数都是<code>int</code>类型的。这些参数所代表的分别是想要创建的socket实例通信域、类型以及使用的协议。</p><p>Socket的通信域主要有这样几个可选项：IPv4域、IPv6域和Unix域。</p><p>我想你应该能够猜出<strong>IPv4域、IPv6域</strong>的含义，它们对应的分别是基于IP协议第四版的网络，和基于IP协议第六版的网络。</p><p>现在的计算机网络大都是基于IP协议第四版的，但是由于现有IP地址的逐渐枯竭，网络世界也在逐步地支持IP协议第六版。</p><p><strong>Unix域</strong>，指的是一种类Unix操作系统中特有的通信域。在装有此类操作系统的同一台计算机中，应用程序可以基于此域建立socket连接。</p><p>以上三种通信域分别可以由<code>syscall</code>代码包中的常量<code>AF_INET</code>、<code>AF_INET6</code>和<code>AF_UNIX</code>表示。</p><p>Socket的类型一共有4种，分别是：<code>SOCK_DGRAM</code>、<code>SOCK_STREAM</code>、<code>SOCK_SEQPACKET</code>以及<code>SOCK_RAW</code>。<code>syscall</code>代码包中也都有同名的常量与之对应。前两者更加常用一些。</p><p><code>SOCK_DGRAM</code>中的“DGRAM”代表的是datagram，即数据报文。它是一种有消息边界，但没有逻辑连接的非可靠socket类型，我们熟知的基于UDP协议的网络通信就属于此类。</p><p>有消息边界的意思是，与socket相关的操作系统内核中的程序（以下简称内核程序）在发送或接收数据的时候是以消息为单位的。</p><p>你可以把消息理解为带有固定边界的一段数据。内核程序可以自动地识别和维护这种边界，并在必要的时候，把数据切割成一个一个的消息，或者把多个消息串接成连续的数据。如此一来，应用程序只需要面向消息进行处理就可以了。</p><p>所谓的有逻辑连接是指，通信双方在收发数据之前必须先建立网络连接。待连接建立好之后，双方就可以一对一地进行数据传输了。显然，基于UDP协议的网络通信并不需要这样，它是没有逻辑连接的。</p><p>只要应用程序指定好对方的网络地址，内核程序就可以立即把数据报文发送出去。这有优势，也有劣势。</p><p>优势是发送速度快，不长期占用网络资源，并且每次发送都可以指定不同的网络地址。</p><p>当然了，最后一个优势有时候也是劣势，因为这会使数据报文更长一些。其他的劣势有，无法保证传输的可靠性，不能实现数据的有序性，以及数据只能单向进行传输。</p><p>而<code>SOCK_STREAM</code>这个socket类型，恰恰与<code>SOCK_DGRAM</code>相反。<strong>它没有消息边界，但有逻辑连接，能够保证传输的可靠性和数据的有序性，同时还可以实现数据的双向传输。</strong>众所周知的基于TCP协议的网络通信就属于此类。</p><blockquote>
<p><span class="reference">这样的网络通信传输数据的形式是字节流，而不是数据报文。字节流是以字节为单位的。内核程序无法感知一段字节流中包含了多少个消息，以及这些消息是否完整，这完全需要应用程序自己去把控。</span></p>
<p><span class="reference">不过，此类网络通信中的一端，总是会忠实地按照另一端发送数据时的字节排列顺序，接收和缓存它们。所以，应用程序需要根据双方的约定去数据中查找消息边界，并按照边界切割数据，仅此而已。</span></p>
</blockquote><p><code>syscall.Socket</code>函数的第三个参数用于表示socket实例所使用的协议。</p><p>通常，只要明确指定了前两个参数的值，我们就无需再去确定第三个参数值了，一般把它置为<code>0</code>就可以了。这时，内核程序会自行选择最合适的协议。</p><p>比如，当前两个参数值分别为<code>syscall.AF_INET</code>和<code>syscall.SOCK_DGRAM</code>的时候，内核程序会选择UDP作为协议。</p><p>又比如，在前两个参数值分别为<code>syscall.AF_INET6</code>和<code>syscall.SOCK_STREAM</code>时，内核程序可能会选择TCP作为协议。</p><p><img src="https://static001.geekbang.org/resource/image/99/69/99f8a0405a98ea16495364be352fe969.png?wh=1481*731" alt=""><br>
（syscall.Socket函数一瞥）</p><p>不过，你也看到了，在使用<code>net</code>包中的高层次API的时候，我们连那前两个参数值都无需给定，只需要把前面罗列的那些字符串字面量的其中一个，作为<code>network</code>参数的值就好了。</p><p>当然，如果你在使用这些API的时候，能够想到我在上面说的这些基础知识的话，那么一定会对你做出正确的判断和选择有所帮助。</p><h2>知识扩展</h2><h3>问题1：调用<code>net.DialTimeout</code>函数时给定的超时时间意味着什么？</h3><p>简单来说，这里的超时时间，代表着函数为网络连接建立完成而等待的最长时间。这是一个相对的时间。它会由这个函数的参数<code>timeout</code>的值表示。</p><p>开始的时间点几乎是我们调用<code>net.DialTimeout</code>函数的那一刻。在这之后，时间会主要花费在“解析参数<code>network</code>和<code>address</code>的值”，以及“创建socket实例并建立网络连接”这两件事情上。</p><p>不论执行到哪一步，只要在绝对的超时时间达到的那一刻，网络连接还没有建立完成，该函数就会返回一个代表了I/O操作超时的错误值。</p><p>值得注意的是，在解析<code>address</code>的值的时候，函数会确定网络服务的IP地址、端口号等必要信息，并在需要时访问DNS服务。</p><p>另外，如果解析出的IP地址有多个，那么函数会串行或并发地尝试建立连接。但无论用什么样的方式尝试，函数总会以最先建立成功的那个连接为准。</p><p>同时，它还会根据超时前的剩余时间，去设定针对每次连接尝试的超时时间，以便让它们都有适当的时间执行。</p><p>再多说一点。在<code>net</code>包中还有一个名为<code>Dialer</code>的结构体类型。该类型有一个名叫<code>Timeout</code>的字段，它与上述的<code>timeout</code>参数的含义是完全一致的。实际上，<code>net.DialTimeout</code>函数正是利用了这个类型的值才得以实现功能的。</p><p><code>net.Dialer</code>类型值得你好好学习一下，尤其是它的每个字段的功用以及它的<code>DialContext</code>方法。</p><h2>总结</h2><p>我们今天提及了使用Go语言进行网络编程这个主题。作为引子，我先向你介绍了关于socket的一些基础知识。socket常被翻译为套接字，它是一种IPC方法。IPC可以被翻译为进程间通信，它主要定义了多个进程之间相互通信的方法。</p><p>Socket是IPC方法中最为通用和灵活的一种。与其他的方法不同，利用socket进行通信的进程可以不局限在同一台计算机当中。</p><p>只要通信的双方能够通过计算机的网卡端口，以及网络进行互联就可以使用socket，无论它们存在于世界上的哪个角落。</p><p>支持socket的操作系统一般都会对外提供一套API。Go语言的<code>syscall</code>代码包中也有与之对应的程序实体。其中最重要的一个就是<code>syscall.Socket</code>函数。</p><p>不过，<code>syscall</code>包中的这些程序实体，对于普通的Go程序来说都属于底层的东西了，我们通常很少会用到。一般情况下，我们都会使用<code>net</code>代码包及其子包中的API去编写网络程序。</p><p><code>net</code>包中一个很常用的函数，名为<code>Dial</code>。这个函数主要用于连接网络服务。它会接受两个参数，你需要搞明白这两个参数的值都应该怎么去设定。</p><p>尤其是<code>network</code>参数，它有很多的可选值，其中最常用的有9个。这些可选值的背后都代表着相应的socket属性，包括通信域、类型以及使用的协议。一旦你理解了这些socket属性，就一定会帮助你做出正确的判断和选择。</p><p>与此相关的一个函数是<code>net.DialTimeout</code>。我们在调用它的时候需要设定一个超时时间。这个超时时间的含义你是需要搞清楚的。</p><p>通过它，我们可以牵扯出这个函数的一大堆实现细节。另外，还有一个叫做<code>net.Dialer</code>的结构体类型。这个类型其实是前述两个函数的底层实现，值得你好好地学习一番。</p><p>以上，就是我今天讲的主要内容，它们都是关于怎样访问网络服务的。你可以从这里入手，进入Go语言的网络编程世界。</p><h2>思考题</h2><p>今天的思考题也与超时时间有关。在你调用了<code>net.Dial</code>等函数之后，如果成功就会得到一个代表了网络连接的<code>net.Conn</code>接口类型的值。我的问题是：怎样在<code>net.Conn</code>类型的值上正确地设定针对读操作和写操作的超时时间？</p><p><a href="https://github.com/hyper0x/Golang_Puzzlers">戳此查看Go语言专栏文章配套详细代码。</a></p><p></p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/14/b1/0f/e81a93ed.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>嘎嘎</span>
  </div>
  <div class="_2_QraFYR_0">net.Conn接口提供了SetDeadline, SetReadDeadline, SetWriteDeadline；调用SetDeadline方法等于同时调用了后两个方法，因为其最总调用的setDeadlineImpl(fd, t, &#39;r&#39;+&#39;w&#39;) 对读和写都设置了超时时间。</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">作者回复: 对的。</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-04-04 17:24:26</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/8b/15/5278f52a.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>春暖花开</span>
  </div>
  <div class="_2_QraFYR_0">go对tcp包的粘包怎么处理的</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-26 20:13:54</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/62/81/ad80f427.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Lane</span>
  </div>
  <div class="_2_QraFYR_0">粘包难道不应该业务层去做吗</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-27 12:48:58</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/c1/4c/e72d3360.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>NulI</span>
  </div>
  <div class="_2_QraFYR_0">今天是教师节，祝郝老师节日快乐！</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">作者回复: 谢谢！</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-09-10 17:53:29</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/62/81/ad80f427.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Lane</span>
  </div>
  <div class="_2_QraFYR_0">请问老师：golang内置的是epoll还是select。不像我们自主编写的时候会显示的调用select或者epoll、libevent之类的</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">作者回复: Linux下的话是epoll。</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-27 12:50:30</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>My dream</span>
  </div>
  <div class="_2_QraFYR_0">请老师讲一下用nginx搭建go的服务器环境嘛，因为nginx更适合处理静态文件，go更适合处理动态文件，但我不知如何下手去搭建这样的环境</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-27 07:00:50</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIbR6cVic3C9rVUxaw4ic7C7txaCBnoxDoGMcfFQzibrJicW9yZkXIRdWpsxwgzEAZWBhFzHDhNqQicVZg/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ipfs</span>
  </div>
  <div class="_2_QraFYR_0">老师您好，我工作多年，现在准备学习go语言进入区块链，现在想努力学习下网络编程，您有网络开发课程吗？或书籍，亦或者推荐的资料，谢谢</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">作者回复: 你好，我目前没有搞网络开发课程。搞网络编程的话先熟悉熟悉网络协议吧。</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-01-12 18:22:23</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/8b/15/5278f52a.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>春暖花开</span>
  </div>
  <div class="_2_QraFYR_0">go有没有类似jave的netty库</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-26 20:12:20</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/14/e5/181abc46.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Spiderspiders</span>
  </div>
  <div class="_2_QraFYR_0">它是一种有数消息边界但没有逻辑连接的非可靠 socket 类型，我们熟知的基于 UDP 协议的网络通信就属于此类。<br><br>这里多了一个数，应该是有消息边界，而不是有数消息边界</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">作者回复: 我已经提给编辑了，谢谢！</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-04-05 10:40:53</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/20/27/a6932fbe.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>虢國技醬</span>
  </div>
  <div class="_2_QraFYR_0">打卡：<br>SetDeadline()<br>SetReadDeadline()<br>SetWriteDeadline()</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-03-15 00:41:39</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/4f/ef/57847b72.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>beyondkmp</span>
  </div>
  <div class="_2_QraFYR_0">golang里面的并发dial，看了下dial的源代码应该是双栈ipv4和ipv6的并发，会同时对ipv4地址组和ipv6地址组，两组地址进行并发连接，哪个快用哪个。</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-02-25 17:17:30</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>My dream</span>
  </div>
  <div class="_2_QraFYR_0">特别是基于https的</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-27 07:01:35</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/a0/c5/9259d5ca.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>daydaygo</span>
  </div>
  <div class="_2_QraFYR_0">这个问题适合画图解决: 而且由于协议是一层包一层, 特别适合使用递归的方式: http层 -&gt; tcp层 -&gt; ip层, 逐层解决</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-11-13 14:08:34</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/3b/ba/3b30dcde.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>窝窝头</span>
  </div>
  <div class="_2_QraFYR_0">dialer提供了SetWriteDeadline以及SetReadDeadline函数用于设置超时时间</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2022-05-17 16:39:54</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>jxs1211</span>
  </div>
  <div class="_2_QraFYR_0"> go run &#39;.\demo91 copy.go&#39;<br>fork&#47;exec C:\Users\xxxxx\AppData\Local\Temp\go-build161103554\b001\exe\demo91 copy.exe: Access is denied.<br>请问这个应该怎么解决，网上找了都没有用，windows环境</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">作者回复: copy.go 是什么？<br><br>如果你要运行 demo91.go ，在那个目录下直接执行 go run demo91.go 就好了。</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-10-12 23:29:37</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/13/09/22/22c0c4fa.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>benying</span>
  </div>
  <div class="_2_QraFYR_0">打卡</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-06-11 22:23:53</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src=""
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>一直说自己小怂包</span>
  </div>
  <div class="_2_QraFYR_0">net.Dial函数内部调用net.Dialer类型的Dial方法</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-01-18 10:55:39</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/57/c5/a0c99b33.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Rand01ph</span>
  </div>
  <div class="_2_QraFYR_0">另外，如果解析出的 IP 地址有多个，那么函数会串行或并发地尝试建立连接。这是有参数控制串行或并发么</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-27 09:46:48</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/4c/fc/0e887697.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>kkgo</span>
  </div>
  <div class="_2_QraFYR_0">老师，你是否在开go课程项目实战</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2018-11-26 15:46:59</div>
  </div>
</div>
</div>
</li>
</ul>