<audio title="24 _ ç‰©ç†å†…å­˜ç®¡ç†ï¼ˆä¸‹ï¼‰ï¼šä¼šè®®å®¤ç®¡ç†å‘˜å¦‚ä½•åˆ†é…ä¼šè®®å®¤ï¼Ÿ" src="https://static001.geekbang.org/resource/audio/30/e9/3042e6821d9fb594b50a7454c3ffafe9.mp3" controls="controls"></audio> 
<p>å‰ä¸€èŠ‚ï¼Œå‰é¢æˆ‘ä»¬è§£æäº†æ•´é¡µçš„åˆ†é…æœºåˆ¶ã€‚å¦‚æœé‡åˆ°å°çš„å¯¹è±¡ï¼Œç‰©ç†å†…å­˜æ˜¯å¦‚ä½•åˆ†é…çš„å‘¢ï¼Ÿè¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€çœ‹ã€‚</p><h2>å°å†…å­˜çš„åˆ†é…</h2><p>å‰é¢æˆ‘ä»¬è®²è¿‡ï¼Œå¦‚æœé‡åˆ°å°çš„å¯¹è±¡ï¼Œä¼šä½¿ç”¨slubåˆ†é…å™¨è¿›è¡Œåˆ†é…ã€‚é‚£æˆ‘ä»¬å°±å…ˆæ¥è§£æå®ƒçš„å·¥ä½œåŸç†ã€‚</p><p>è¿˜è®°å¾—å’±ä»¬åˆ›å»ºè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨dup_task_structï¼Œå®ƒæƒ³è¦è¯•å›¾å¤åˆ¶ä¸€ä¸ªtask_structå¯¹è±¡ï¼Œéœ€è¦å…ˆè°ƒç”¨alloc_task_struct_nodeï¼Œåˆ†é…ä¸€ä¸ªtask_structå¯¹è±¡ã€‚</p><p>ä»è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œå®ƒè°ƒç”¨äº†kmem_cache_alloc_nodeå‡½æ•°ï¼Œåœ¨task_structçš„ç¼“å­˜åŒºåŸŸtask_struct_cachepåˆ†é…äº†ä¸€å—å†…å­˜ã€‚</p><pre><code>static struct kmem_cache *task_struct_cachep;

task_struct_cachep = kmem_cache_create(&quot;task_struct&quot;,
			arch_task_struct_size, align,
			SLAB_PANIC|SLAB_NOTRACK|SLAB_ACCOUNT, NULL);

static inline struct task_struct *alloc_task_struct_node(int node)
{
	return kmem_cache_alloc_node(task_struct_cachep, GFP_KERNEL, node);
}

static inline void free_task_struct(struct task_struct *tsk)
{
	kmem_cache_free(task_struct_cachep, tsk);
}
</code></pre><p>åœ¨ç³»ç»Ÿåˆå§‹åŒ–çš„æ—¶å€™ï¼Œtask_struct_cachepä¼šè¢«kmem_cache_createå‡½æ•°åˆ›å»ºã€‚è¿™ä¸ªå‡½æ•°ä¹Ÿæ¯”è¾ƒå®¹æ˜“çœ‹æ‡‚ï¼Œä¸“é—¨ç”¨äºåˆ†é…task_structå¯¹è±¡çš„ç¼“å­˜ã€‚è¿™ä¸ªç¼“å­˜åŒºçš„åå­—å°±å«task_structã€‚ç¼“å­˜åŒºä¸­æ¯ä¸€å—çš„å¤§å°æ­£å¥½ç­‰äºtask_structçš„å¤§å°ï¼Œä¹Ÿå³arch_task_struct_sizeã€‚</p><p>æœ‰äº†è¿™ä¸ªç¼“å­˜åŒºï¼Œæ¯æ¬¡åˆ›å»ºtask_structçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ç”¨åˆ°å†…å­˜é‡Œé¢å»åˆ†é…ï¼Œå…ˆåœ¨ç¼“å­˜é‡Œé¢çœ‹çœ‹æœ‰æ²¡æœ‰ç›´æ¥å¯ç”¨çš„ï¼Œè¿™å°±æ˜¯<strong>kmem_cache_alloc_node</strong>çš„ä½œç”¨ã€‚</p><!-- [[[read_end]]] --><p>å½“ä¸€ä¸ªè¿›ç¨‹ç»“æŸï¼Œtask_structä¹Ÿä¸ç”¨ç›´æ¥è¢«é”€æ¯ï¼Œè€Œæ˜¯æ”¾å›åˆ°ç¼“å­˜ä¸­ï¼Œè¿™å°±æ˜¯<strong>kmem_cache_free</strong>çš„ä½œç”¨ã€‚è¿™æ ·ï¼Œæ–°è¿›ç¨‹åˆ›å»ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨ç°æˆçš„ç¼“å­˜ä¸­çš„task_structäº†ã€‚</p><p>æˆ‘ä»¬æ¥ä»”ç»†çœ‹çœ‹ï¼Œç¼“å­˜åŒºstruct kmem_cacheåˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­ã€‚</p><pre><code>struct kmem_cache {
	struct kmem_cache_cpu __percpu *cpu_slab;
	/* Used for retriving partial slabs etc */
	unsigned long flags;
	unsigned long min_partial;
	int size;		/* The size of an object including meta data */
	int object_size;	/* The size of an object without meta data */
	int offset;		/* Free pointer offset. */
#ifdef CONFIG_SLUB_CPU_PARTIAL
	int cpu_partial;	/* Number of per cpu partial objects to keep around */
#endif
	struct kmem_cache_order_objects oo;
	/* Allocation and freeing of slabs */
	struct kmem_cache_order_objects max;
	struct kmem_cache_order_objects min;
	gfp_t allocflags;	/* gfp flags to use on each alloc */
	int refcount;		/* Refcount for slab cache destroy */
	void (*ctor)(void *);
......
	const char *name;	/* Name (only for display!) */
	struct list_head list;	/* List of slab caches */
......
	struct kmem_cache_node *node[MAX_NUMNODES];
};

</code></pre><p>åœ¨struct kmem_cacheé‡Œé¢ï¼Œæœ‰ä¸ªå˜é‡struct list_head listï¼Œè¿™ä¸ªç»“æ„æˆ‘ä»¬å·²ç»çœ‹åˆ°è¿‡å¤šæ¬¡äº†ã€‚æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿæ¥è®²ï¼Œè¦åˆ›å»ºå’Œç®¡ç†çš„ç¼“å­˜ç»å¯¹ä¸æ­¢task_structã€‚éš¾é“mm_structå°±ä¸éœ€è¦å—ï¼Ÿfs_structå°±ä¸éœ€è¦å—ï¼Ÿéƒ½éœ€è¦ã€‚å› æ­¤ï¼Œæ‰€æœ‰çš„ç¼“å­˜æœ€åéƒ½ä¼šæ”¾åœ¨ä¸€ä¸ªé“¾è¡¨é‡Œé¢ï¼Œä¹Ÿå°±æ˜¯LIST_HEAD(slab_caches)ã€‚</p><p>å¯¹äºç¼“å­˜æ¥è®²ï¼Œå…¶å®å°±æ˜¯åˆ†é…äº†è¿ç»­å‡ é¡µçš„å¤§å†…å­˜å—ï¼Œç„¶åæ ¹æ®ç¼“å­˜å¯¹è±¡çš„å¤§å°ï¼Œåˆ‡æˆå°å†…å­˜å—ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œæœ‰ä¸‰ä¸ªkmem_cache_order_objectsç±»å‹çš„å˜é‡ã€‚è¿™é‡Œé¢çš„orderï¼Œå°±æ˜¯2çš„orderæ¬¡æ–¹ä¸ªé¡µé¢çš„å¤§å†…å­˜å—ï¼Œobjectså°±æ˜¯èƒ½å¤Ÿå­˜æ”¾çš„ç¼“å­˜å¯¹è±¡çš„æ•°é‡ã€‚</p><p>æœ€ç»ˆï¼Œæˆ‘ä»¬å°†å¤§å†…å­˜å—åˆ‡åˆ†æˆå°å†…å­˜å—ï¼Œæ ·å­å°±åƒä¸‹é¢è¿™æ ·ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/17/5e/172839800c8d51c49b67ec8c4d07315e.jpeg?wh=2483*1523" alt=""></p><p>æ¯ä¸€é¡¹çš„ç»“æ„éƒ½æ˜¯ç¼“å­˜å¯¹è±¡åé¢è·Ÿä¸€ä¸ªä¸‹ä¸€ä¸ªç©ºé—²å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¿™æ ·éå¸¸æ–¹ä¾¿å°†æ‰€æœ‰çš„ç©ºé—²å¯¹è±¡é“¾æˆä¸€ä¸ªé“¾ã€‚å…¶å®ï¼Œè¿™å°±ç›¸å½“äºå’±ä»¬æ•°æ®ç»“æ„é‡Œé¢å­¦çš„ï¼Œç”¨æ•°ç»„å®ç°ä¸€ä¸ªå¯éšæœºæ’å…¥å’Œåˆ é™¤çš„é“¾è¡¨ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™é‡Œé¢å°±æœ‰ä¸‰ä¸ªå˜é‡ï¼šsizeæ˜¯åŒ…å«è¿™ä¸ªæŒ‡é’ˆçš„å¤§å°ï¼Œobject_sizeæ˜¯çº¯å¯¹è±¡çš„å¤§å°ï¼Œoffsetå°±æ˜¯æŠŠä¸‹ä¸€ä¸ªç©ºé—²å¯¹è±¡çš„æŒ‡é’ˆå­˜æ”¾åœ¨è¿™ä¸€é¡¹é‡Œçš„åç§»é‡ã€‚</p><p>é‚£è¿™äº›ç¼“å­˜å¯¹è±¡å“ªäº›è¢«åˆ†é…äº†ã€å“ªäº›åœ¨ç©ºç€ï¼Œä»€ä¹ˆæƒ…å†µä¸‹æ•´ä¸ªå¤§å†…å­˜å—éƒ½è¢«åˆ†é…å®Œäº†ï¼Œéœ€è¦å‘ä¼™ä¼´ç³»ç»Ÿç”³è¯·å‡ ä¸ªé¡µå½¢æˆæ–°çš„å¤§å†…å­˜å—ï¼Ÿè¿™äº›ä¿¡æ¯è¯¥ç”±è°æ¥ç»´æŠ¤å‘¢ï¼Ÿ</p><p>æ¥ä¸‹æ¥å°±æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªæˆå‘˜å˜é‡å‡ºåœºçš„æ—¶å€™äº†ã€‚kmem_cache_cpuå’Œkmem_cache_nodeï¼Œå®ƒä»¬éƒ½æ˜¯æ¯ä¸ªNUMAèŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªï¼Œæˆ‘ä»¬åªéœ€è¦çœ‹ä¸€ä¸ªèŠ‚ç‚¹é‡Œé¢çš„æƒ…å†µã€‚</p><p><img src="https://static001.geekbang.org/resource/image/45/0a/45f38a0c7bce8c98881bbe8b8b4c190a.jpeg?wh=2603*2033" alt=""></p><p>åœ¨åˆ†é…ç¼“å­˜å—çš„æ—¶å€™ï¼Œè¦åˆ†ä¸¤ç§è·¯å¾„ï¼Œ<strong>fast path</strong>å’Œ<strong>slow path</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>å¿«é€Ÿé€šé“</strong>å’Œ<strong>æ™®é€šé€šé“</strong>ã€‚å…¶ä¸­kmem_cache_cpuå°±æ˜¯å¿«é€Ÿé€šé“ï¼Œkmem_cache_nodeæ˜¯æ™®é€šé€šé“ã€‚æ¯æ¬¡åˆ†é…çš„æ—¶å€™ï¼Œè¦å…ˆä»kmem_cache_cpuè¿›è¡Œåˆ†é…ã€‚å¦‚æœkmem_cache_cpué‡Œé¢æ²¡æœ‰ç©ºé—²çš„å—ï¼Œé‚£å°±åˆ°kmem_cache_nodeä¸­è¿›è¡Œåˆ†é…ï¼›å¦‚æœè¿˜æ˜¯æ²¡æœ‰ç©ºé—²çš„å—ï¼Œæ‰å»ä¼™ä¼´ç³»ç»Ÿåˆ†é…æ–°çš„é¡µã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œkmem_cache_cpué‡Œé¢æ˜¯å¦‚ä½•å­˜æ”¾ç¼“å­˜å—çš„ã€‚</p><pre><code>struct kmem_cache_cpu {
	void **freelist;	/* Pointer to next available object */
	unsigned long tid;	/* Globally unique transaction id */
	struct page *page;	/* The slab from which we are allocating */
#ifdef CONFIG_SLUB_CPU_PARTIAL
	struct page *partial;	/* Partially allocated frozen slabs */
#endif
......
};
</code></pre><p>åœ¨è¿™é‡Œï¼ŒpageæŒ‡å‘å¤§å†…å­˜å—çš„ç¬¬ä¸€ä¸ªé¡µï¼Œç¼“å­˜å—å°±æ˜¯ä»é‡Œé¢åˆ†é…çš„ã€‚freelistæŒ‡å‘å¤§å†…å­˜å—é‡Œé¢ç¬¬ä¸€ä¸ªç©ºé—²çš„é¡¹ã€‚æŒ‰ç…§ä¸Šé¢è¯´çš„ï¼Œè¿™ä¸€é¡¹ä¼šæœ‰æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²çš„é¡¹ï¼Œæœ€ç»ˆæ‰€æœ‰ç©ºé—²çš„é¡¹ä¼šå½¢æˆä¸€ä¸ªé“¾è¡¨ã€‚</p><p>partialæŒ‡å‘çš„ä¹Ÿæ˜¯å¤§å†…å­˜å—çš„ç¬¬ä¸€ä¸ªé¡µï¼Œä¹‹æ‰€ä»¥åå­—å«partialï¼ˆéƒ¨åˆ†ï¼‰ï¼Œå°±æ˜¯å› ä¸ºå®ƒé‡Œé¢éƒ¨åˆ†è¢«åˆ†é…å‡ºå»äº†ï¼Œéƒ¨åˆ†æ˜¯ç©ºçš„ã€‚è¿™æ˜¯ä¸€ä¸ªå¤‡ç”¨åˆ—è¡¨ï¼Œå½“pageæ»¡äº†ï¼Œå°±ä¼šä»è¿™é‡Œæ‰¾ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹kmem_cache_nodeçš„å®šä¹‰ã€‚</p><pre><code>struct kmem_cache_node {
	spinlock_t list_lock;
......
#ifdef CONFIG_SLUB
	unsigned long nr_partial;
	struct list_head partial;
......
#endif
};
</code></pre><p>è¿™é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªpartialï¼Œæ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚è¿™ä¸ªé“¾è¡¨é‡Œå­˜æ”¾çš„æ˜¯éƒ¨åˆ†ç©ºé—²çš„å†…å­˜å—ã€‚è¿™æ˜¯kmem_cache_cpué‡Œé¢çš„partialçš„å¤‡ç”¨åˆ—è¡¨ï¼Œå¦‚æœé‚£é‡Œæ²¡æœ‰ï¼Œå°±åˆ°è¿™é‡Œæ¥æ‰¾ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿™ä¸ªåˆ†é…è¿‡ç¨‹ã€‚kmem_cache_alloc_nodeä¼šè°ƒç”¨slab_alloc_nodeã€‚ä½ è¿˜æ˜¯å…ˆé‡ç‚¹çœ‹è¿™é‡Œé¢çš„æ³¨é‡Šï¼Œè¿™é‡Œé¢è¯´çš„å°±æ˜¯å¿«é€Ÿé€šé“å’Œæ™®é€šé€šé“çš„æ¦‚å¿µã€‚</p><pre><code>/*
 * Inlined fastpath so that allocation functions (kmalloc, kmem_cache_alloc)
 * have the fastpath folded into their functions. So no function call
 * overhead for requests that can be satisfied on the fastpath.
 *
 * The fastpath works by first checking if the lockless freelist can be used.
 * If not then __slab_alloc is called for slow processing.
 *
 * Otherwise we can simply pick the next object from the lockless free list.
 */
static __always_inline void *slab_alloc_node(struct kmem_cache *s,
		gfp_t gfpflags, int node, unsigned long addr)
{
	void *object;
	struct kmem_cache_cpu *c;
	struct page *page;
	unsigned long tid;
......
	tid = this_cpu_read(s-&gt;cpu_slab-&gt;tid);
	c = raw_cpu_ptr(s-&gt;cpu_slab);
......
	object = c-&gt;freelist;
	page = c-&gt;page;
	if (unlikely(!object || !node_match(page, node))) {
		object = __slab_alloc(s, gfpflags, node, addr, c);
		stat(s, ALLOC_SLOWPATH);
	} 
......
	return object;
}
</code></pre><p>å¿«é€Ÿé€šé“å¾ˆç®€å•ï¼Œå–å‡ºcpu_slabä¹Ÿå³kmem_cache_cpuçš„freelistï¼Œè¿™å°±æ˜¯ç¬¬ä¸€ä¸ªç©ºé—²çš„é¡¹ï¼Œå¯ä»¥ç›´æ¥è¿”å›äº†ã€‚å¦‚æœæ²¡æœ‰ç©ºé—²çš„äº†ï¼Œåˆ™åªå¥½è¿›å…¥æ™®é€šé€šé“ï¼Œè°ƒç”¨__slab_allocã€‚</p><pre><code>static void *___slab_alloc(struct kmem_cache *s, gfp_t gfpflags, int node,
			  unsigned long addr, struct kmem_cache_cpu *c)
{
	void *freelist;
	struct page *page;
......
redo:
......
	/* must check again c-&gt;freelist in case of cpu migration or IRQ */
	freelist = c-&gt;freelist;
	if (freelist)
		goto load_freelist;


	freelist = get_freelist(s, page);


	if (!freelist) {
		c-&gt;page = NULL;
		stat(s, DEACTIVATE_BYPASS);
		goto new_slab;
	}


load_freelist:
	c-&gt;freelist = get_freepointer(s, freelist);
	c-&gt;tid = next_tid(c-&gt;tid);
	return freelist;


new_slab:


	if (slub_percpu_partial(c)) {
		page = c-&gt;page = slub_percpu_partial(c);
		slub_set_percpu_partial(c, page);
		stat(s, CPU_PARTIAL_ALLOC);
		goto redo;
	}


	freelist = new_slab_objects(s, gfpflags, node, &amp;c);
......
	return freeli

</code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆå†æ¬¡å°è¯•ä¸€ä¸‹kmem_cache_cpuçš„freelistã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸‡ä¸€å½“å‰è¿›ç¨‹è¢«ä¸­æ–­ï¼Œç­‰å›æ¥çš„æ—¶å€™ï¼Œåˆ«äººå·²ç»é‡Šæ”¾äº†ä¸€äº›ç¼“å­˜ï¼Œè¯´ä¸å®šåˆæœ‰ç©ºé—´äº†å‘¢ã€‚å¦‚æœæ‰¾åˆ°äº†ï¼Œå°±è·³åˆ°load_freelistï¼Œåœ¨è¿™é‡Œå°†freelistæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²é¡¹ï¼Œè¿”å›å°±å¯ä»¥äº†ã€‚</p><p>å¦‚æœfreelistè¿˜æ˜¯æ²¡æœ‰ï¼Œåˆ™è·³åˆ°new_slabé‡Œé¢å»ã€‚è¿™é‡Œé¢æˆ‘ä»¬å…ˆå»kmem_cache_cpuçš„partialé‡Œé¢çœ‹ã€‚å¦‚æœpartialä¸æ˜¯ç©ºçš„ï¼Œé‚£å°±å°†kmem_cache_cpuçš„pageï¼Œä¹Ÿå°±æ˜¯å¿«é€Ÿé€šé“çš„é‚£ä¸€å¤§å—å†…å­˜ï¼Œæ›¿æ¢ä¸ºpartialé‡Œé¢çš„å¤§å—å†…å­˜ã€‚ç„¶åredoï¼Œé‡æ–°è¯•ä¸‹ã€‚è¿™æ¬¡åº”è¯¥å°±å¯ä»¥æˆåŠŸäº†ã€‚</p><p>å¦‚æœçœŸçš„è¿˜ä¸è¡Œï¼Œé‚£å°±è¦åˆ°new_slab_objectsäº†ã€‚</p><pre><code>static inline void *new_slab_objects(struct kmem_cache *s, gfp_t flags,
			int node, struct kmem_cache_cpu **pc)
{
	void *freelist;
	struct kmem_cache_cpu *c = *pc;
	struct page *page;


	freelist = get_partial(s, flags, node, c);


	if (freelist)
		return freelist;


	page = new_slab(s, flags, node);
	if (page) {
		c = raw_cpu_ptr(s-&gt;cpu_slab);
		if (c-&gt;page)
			flush_slab(s, c);


		freelist = page-&gt;freelist;
		page-&gt;freelist = NULL;


		stat(s, ALLOC_SLAB);
		c-&gt;page = page;
		*pc = c;
	} else
		freelist = NULL;


	return freelis
</code></pre><p>åœ¨è¿™é‡Œé¢ï¼Œget_partialä¼šæ ¹æ®node idï¼Œæ‰¾åˆ°ç›¸åº”çš„kmem_cache_nodeï¼Œç„¶åè°ƒç”¨get_partial_nodeï¼Œå¼€å§‹åœ¨è¿™ä¸ªèŠ‚ç‚¹è¿›è¡Œåˆ†é…ã€‚</p><pre><code>/*
 * Try to allocate a partial slab from a specific node.
 */
static void *get_partial_node(struct kmem_cache *s, struct kmem_cache_node *n,
				struct kmem_cache_cpu *c, gfp_t flags)
{
	struct page *page, *page2;
	void *object = NULL;
	int available = 0;
	int objects;
......
	list_for_each_entry_safe(page, page2, &amp;n-&gt;partial, lru) {
		void *t;


		t = acquire_slab(s, n, page, object == NULL, &amp;objects);
		if (!t)
			break;


		available += objects;
		if (!object) {
			c-&gt;page = page;
			stat(s, ALLOC_FROM_PARTIAL);
			object = t;
		} else {
			put_cpu_partial(s, page, 0);
			stat(s, CPU_PARTIAL_NODE);
		}
		if (!kmem_cache_has_cpu_partial(s)
			|| available &gt; slub_cpu_partial(s) / 2)
			break;
	}
......
	return object;
</code></pre><p>acquire_slabä¼šä»kmem_cache_nodeçš„partialé“¾è¡¨ä¸­æ‹¿ä¸‹ä¸€å¤§å—å†…å­˜æ¥ï¼Œå¹¶ä¸”å°†freelistï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€å—ç©ºé—²çš„ç¼“å­˜å—ï¼Œèµ‹å€¼ç»™tã€‚å¹¶ä¸”å½“ç¬¬ä¸€è½®å¾ªç¯çš„æ—¶å€™ï¼Œå°†kmem_cache_cpuçš„pageæŒ‡å‘å–ä¸‹æ¥çš„è¿™ä¸€å¤§å—å†…å­˜ï¼Œè¿”å›çš„objectå°±æ˜¯è¿™å—å†…å­˜é‡Œé¢çš„ç¬¬ä¸€ä¸ªç¼“å­˜å—tã€‚å¦‚æœkmem_cache_cpuä¹Ÿæœ‰ä¸€ä¸ªpartialï¼Œå°±ä¼šè¿›è¡Œç¬¬äºŒè½®ï¼Œå†æ¬¡å–ä¸‹ä¸€å¤§å—å†…å­˜æ¥ï¼Œè¿™æ¬¡è°ƒç”¨put_cpu_partialï¼Œæ”¾åˆ°kmem_cache_cpuçš„partialé‡Œé¢ã€‚</p><p>å¦‚æœkmem_cache_nodeé‡Œé¢ä¹Ÿæ²¡æœ‰ç©ºé—²çš„å†…å­˜ï¼Œè¿™å°±è¯´æ˜åŸæ¥åˆ†é…çš„é¡µé‡Œé¢éƒ½æ”¾æ»¡äº†ï¼Œå°±è¦å›åˆ°new_slab_objectså‡½æ•°ï¼Œé‡Œé¢new_slabå‡½æ•°ä¼šè°ƒç”¨allocate_slabã€‚</p><pre><code>static struct page *allocate_slab(struct kmem_cache *s, gfp_t flags, int node)
{
	struct page *page;
	struct kmem_cache_order_objects oo = s-&gt;oo;
	gfp_t alloc_gfp;
	void *start, *p;
	int idx, order;
	bool shuffle;


	flags &amp;= gfp_allowed_mask;
......
	page = alloc_slab_page(s, alloc_gfp, node, oo);
	if (unlikely(!page)) {
		oo = s-&gt;min;
		alloc_gfp = flags;
		/*
		 * Allocation may have failed due to fragmentation.
		 * Try a lower order alloc if possible
		 */
		page = alloc_slab_page(s, alloc_gfp, node, oo);
		if (unlikely(!page))
			goto out;
		stat(s, ORDER_FALLBACK);
	}
......
	return page;
}
</code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†alloc_slab_pageåˆ†é…é¡µé¢ã€‚åˆ†é…çš„æ—¶å€™ï¼Œè¦æŒ‰kmem_cache_order_objectsé‡Œé¢çš„orderæ¥ã€‚å¦‚æœç¬¬ä¸€æ¬¡åˆ†é…ä¸æˆåŠŸï¼Œè¯´æ˜å†…å­˜å·²ç»å¾ˆç´§å¼ äº†ï¼Œé‚£å°±æ¢æˆminç‰ˆæœ¬çš„kmem_cache_order_objectsã€‚</p><p>å¥½äº†ï¼Œè¿™ä¸ªå¤æ‚çš„å±‚å±‚åˆ†é…æœºåˆ¶ï¼Œæˆ‘ä»¬å°±è®²åˆ°è¿™é‡Œï¼Œä½ ç†è§£åˆ°è¿™é‡Œä¹Ÿå°±å¤Ÿç”¨äº†ã€‚</p><h2>é¡µé¢æ¢å‡º</h2><p>å¦ä¸€ä¸ªç‰©ç†å†…å­˜ç®¡ç†å¿…é¡»è¦å¤„ç†çš„äº‹æƒ…å°±æ˜¯ï¼Œé¡µé¢æ¢å‡ºã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ— è®ºæ˜¯32ä½è¿˜æ˜¯64ä½ï¼Œè™šæ‹Ÿåœ°å€ç©ºé—´éƒ½éå¸¸å¤§ï¼Œç‰©ç†å†…å­˜ä¸å¯èƒ½æœ‰è¿™ä¹ˆå¤šçš„ç©ºé—´æ”¾å¾—ä¸‹ã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé¡µé¢åªæœ‰åœ¨è¢«ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šæ”¾åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚å¦‚æœè¿‡äº†ä¸€æ®µæ—¶é—´ä¸è¢«ä½¿ç”¨ï¼Œå³ä¾¿ç”¨æˆ·è¿›ç¨‹å¹¶æ²¡æœ‰é‡Šæ”¾å®ƒï¼Œç‰©ç†å†…å­˜ç®¡ç†ä¹Ÿæœ‰è´£ä»»åšä¸€å®šçš„å¹²é¢„ã€‚ä¾‹å¦‚ï¼Œå°†è¿™äº›ç‰©ç†å†…å­˜ä¸­çš„é¡µé¢æ¢å‡ºåˆ°ç¡¬ç›˜ä¸Šå»ï¼›å°†ç©ºå‡ºçš„ç‰©ç†å†…å­˜ï¼Œäº¤ç»™æ´»è·ƒçš„è¿›ç¨‹å»ä½¿ç”¨ã€‚</p><p>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè§¦å‘é¡µé¢æ¢å‡ºå‘¢ï¼Ÿ</p><p>å¯ä»¥æƒ³è±¡ï¼Œæœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯ï¼Œåˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œå‘ç°æ²¡æœ‰åœ°æ–¹äº†ï¼Œå°±è¯•å›¾å›æ”¶ä¸€ä¸‹ã€‚ä¾‹å¦‚ï¼Œå’±ä»¬è§£æç”³è¯·ä¸€ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨get_page_from_freelistï¼Œæ¥ä¸‹æ¥çš„è°ƒç”¨é“¾ä¸ºget_page_from_freelist-&gt;node_reclaim-&gt;__node_reclaim-&gt;shrink_nodeï¼Œé€šè¿‡è¿™ä¸ªè°ƒç”¨é“¾å¯ä»¥çœ‹å‡ºï¼Œé¡µé¢æ¢å‡ºä¹Ÿæ˜¯ä»¥å†…å­˜èŠ‚ç‚¹ä¸ºå•ä½çš„ã€‚</p><p>å½“ç„¶è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ä½œä¸ºå†…å­˜ç®¡ç†ç³»ç»Ÿåº”è¯¥ä¸»åŠ¨å»åšçš„ï¼Œè€Œä¸èƒ½ç­‰çœŸçš„å‡ºäº†äº‹å„¿å†åšï¼Œè¿™å°±æ˜¯å†…æ ¸çº¿ç¨‹<strong>kswapd</strong>ã€‚è¿™ä¸ªå†…æ ¸çº¿ç¨‹ï¼Œåœ¨ç³»ç»Ÿåˆå§‹åŒ–çš„æ—¶å€™å°±è¢«åˆ›å»ºã€‚è¿™æ ·å®ƒä¼šè¿›å…¥ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œç›´åˆ°ç³»ç»Ÿåœæ­¢ã€‚åœ¨è¿™ä¸ªå¾ªç¯ä¸­ï¼Œå¦‚æœå†…å­˜ä½¿ç”¨æ²¡æœ‰é‚£ä¹ˆç´§å¼ ï¼Œé‚£å®ƒå°±å¯ä»¥æ”¾å¿ƒç¡å¤§è§‰ï¼›å¦‚æœå†…å­˜ç´§å¼ äº†ï¼Œå°±éœ€è¦å»æ£€æŸ¥ä¸€ä¸‹å†…å­˜ï¼Œçœ‹çœ‹æ˜¯å¦éœ€è¦æ¢å‡ºä¸€äº›å†…å­˜é¡µã€‚</p><pre><code>/*
 * The background pageout daemon, started as a kernel thread
 * from the init process.
 *
 * This basically trickles out pages so that we have _some_
 * free memory available even if there is no other activity
 * that frees anything up. This is needed for things like routing
 * etc, where we otherwise might have all activity going on in
 * asynchronous contexts that cannot page things out.
 *
 * If there are applications that are active memory-allocators
 * (most normal use), this basically shouldn't matter.
 */
static int kswapd(void *p)
{
	unsigned int alloc_order, reclaim_order;
	unsigned int classzone_idx = MAX_NR_ZONES - 1;
	pg_data_t *pgdat = (pg_data_t*)p;
	struct task_struct *tsk = current;


    for ( ; ; ) {
......
        kswapd_try_to_sleep(pgdat, alloc_order, reclaim_order,
					classzone_idx);
......
        reclaim_order = balance_pgdat(pgdat, alloc_order, classzone_idx);
......
    }
}

</code></pre><p>è¿™é‡Œçš„è°ƒç”¨é“¾æ˜¯balance_pgdat-&gt;kswapd_shrink_node-&gt;shrink_nodeï¼Œæ˜¯ä»¥å†…å­˜èŠ‚ç‚¹ä¸ºå•ä½çš„ï¼Œæœ€åä¹Ÿæ˜¯è°ƒç”¨shrink_nodeã€‚</p><p>shrink_nodeä¼šè°ƒç”¨shrink_node_memcgã€‚è¿™é‡Œé¢æœ‰ä¸€ä¸ªå¾ªç¯å¤„ç†é¡µé¢çš„åˆ—è¡¨ï¼Œçœ‹è¿™ä¸ªå‡½æ•°çš„æ³¨é‡Šï¼Œå…¶å®å’Œä¸Šé¢æˆ‘ä»¬æƒ³è¡¨è¾¾çš„å†…å­˜æ¢å‡ºæ˜¯ä¸€æ ·çš„ã€‚</p><pre><code>/*
 * This is a basic per-node page freer.  Used by both kswapd and direct reclaim.
 */
static void shrink_node_memcg(struct pglist_data *pgdat, struct mem_cgroup *memcg,
			      struct scan_control *sc, unsigned long *lru_pages)
{
......
	unsigned long nr[NR_LRU_LISTS];
	enum lru_list lru;
......
	while (nr[LRU_INACTIVE_ANON] || nr[LRU_ACTIVE_FILE] ||
					nr[LRU_INACTIVE_FILE]) {
		unsigned long nr_anon, nr_file, percentage;
		unsigned long nr_scanned;


		for_each_evictable_lru(lru) {
			if (nr[lru]) {
				nr_to_scan = min(nr[lru], SWAP_CLUSTER_MAX);
				nr[lru] -= nr_to_scan;


				nr_reclaimed += shrink_list(lru, nr_to_scan,
							    lruvec, memcg, sc);
			}
		}
......
	}
......
</code></pre><p>è¿™é‡Œé¢æœ‰ä¸ªlruåˆ—è¡¨ã€‚ä»ä¸‹é¢çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œæ‰€æœ‰çš„é¡µé¢éƒ½è¢«æŒ‚åœ¨LRUåˆ—è¡¨ä¸­ã€‚LRUæ˜¯Least Recent Useï¼Œä¹Ÿå°±æ˜¯æœ€è¿‘æœ€å°‘ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªåˆ—è¡¨é‡Œé¢ä¼šæŒ‰ç…§æ´»è·ƒç¨‹åº¦è¿›è¡Œæ’åºï¼Œè¿™æ ·å°±å®¹æ˜“æŠŠä¸æ€ä¹ˆç”¨çš„å†…å­˜é¡µæ‹¿å‡ºæ¥åšå¤„ç†ã€‚</p><p>å†…å­˜é¡µæ€»å…±åˆ†ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯<strong>åŒ¿åé¡µ</strong>ï¼Œå’Œè™šæ‹Ÿåœ°å€ç©ºé—´è¿›è¡Œå…³è”ï¼›ä¸€ç±»æ˜¯<strong>å†…å­˜æ˜ å°„</strong>ï¼Œä¸ä½†å’Œè™šæ‹Ÿåœ°å€ç©ºé—´å…³è”ï¼Œè¿˜å’Œæ–‡ä»¶ç®¡ç†å…³è”ã€‚</p><p>å®ƒä»¬æ¯ä¸€ç±»éƒ½æœ‰ä¸¤ä¸ªåˆ—è¡¨ï¼Œä¸€ä¸ªæ˜¯activeï¼Œä¸€ä¸ªæ˜¯inactiveã€‚é¡¾åæ€ä¹‰ï¼Œactiveå°±æ˜¯æ¯”è¾ƒæ´»è·ƒçš„ï¼Œinactiveå°±æ˜¯ä¸æ€ä¹ˆæ´»è·ƒçš„ã€‚è¿™ä¸¤ä¸ªé‡Œé¢çš„é¡µä¼šå˜åŒ–ï¼Œè¿‡ä¸€æ®µæ—¶é—´ï¼Œæ´»è·ƒçš„å¯èƒ½å˜ä¸ºä¸æ´»è·ƒï¼Œä¸æ´»è·ƒçš„å¯èƒ½å˜ä¸ºæ´»è·ƒã€‚å¦‚æœè¦æ¢å‡ºå†…å­˜ï¼Œé‚£å°±æ˜¯ä»ä¸æ´»è·ƒçš„åˆ—è¡¨ä¸­æ‰¾å‡ºæœ€ä¸æ´»è·ƒçš„ï¼Œæ¢å‡ºåˆ°ç¡¬ç›˜ä¸Šã€‚</p><pre><code>enum lru_list {
	LRU_INACTIVE_ANON = LRU_BASE,
	LRU_ACTIVE_ANON = LRU_BASE + LRU_ACTIVE,
	LRU_INACTIVE_FILE = LRU_BASE + LRU_FILE,
	LRU_ACTIVE_FILE = LRU_BASE + LRU_FILE + LRU_ACTIVE,
	LRU_UNEVICTABLE,
	NR_LRU_LISTS
};


#define for_each_evictable_lru(lru) for (lru = 0; lru &lt;= LRU_ACTIVE_FILE; lru++)


static unsigned long shrink_list(enum lru_list lru, unsigned long nr_to_scan,
				 struct lruvec *lruvec, struct mem_cgroup *memcg,
				 struct scan_control *sc)
{
	if (is_active_lru(lru)) {
		if (inactive_list_is_low(lruvec, is_file_lru(lru),
					 memcg, sc, true))
			shrink_active_list(nr_to_scan, lruvec, sc, lru);
		return 0;
	}


	return shrink_inactive_list(nr_to_scan, lruvec, sc, lru);
</code></pre><p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œshrink_listä¼šå…ˆç¼©å‡æ´»è·ƒé¡µé¢åˆ—è¡¨ï¼Œå†å‹ç¼©ä¸æ´»è·ƒçš„é¡µé¢åˆ—è¡¨ã€‚å¯¹äºä¸æ´»è·ƒåˆ—è¡¨çš„ç¼©å‡ï¼Œshrink_inactive_listå°±éœ€è¦å¯¹é¡µé¢è¿›è¡Œå›æ”¶ï¼›å¯¹äºåŒ¿åé¡µæ¥è®²ï¼Œéœ€è¦åˆ†é…swapï¼Œå°†å†…å­˜é¡µå†™å…¥æ–‡ä»¶ç³»ç»Ÿï¼›å¯¹äºå†…å­˜æ˜ å°„å…³è”äº†æ–‡ä»¶çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†åœ¨å†…å­˜ä¸­å¯¹äºæ–‡ä»¶çš„ä¿®æ”¹å†™å›åˆ°æ–‡ä»¶ä¸­ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>å¥½äº†ï¼Œå¯¹äºç‰©ç†å†…å­˜çš„ç®¡ç†å°±è®²åˆ°è¿™é‡Œäº†ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ã€‚å¯¹äºç‰©ç†å†…å­˜æ¥è®²ï¼Œä»ä¸‹å±‚åˆ°ä¸Šå±‚çš„å…³ç³»åŠåˆ†é…æ¨¡å¼å¦‚ä¸‹ï¼š</p><ul>
<li>
<p>ç‰©ç†å†…å­˜åˆ†NUMAèŠ‚ç‚¹ï¼Œåˆ†åˆ«è¿›è¡Œç®¡ç†ï¼›</p>
</li>
<li>
<p>æ¯ä¸ªNUMAèŠ‚ç‚¹åˆ†æˆå¤šä¸ªå†…å­˜åŒºåŸŸï¼›</p>
</li>
<li>
<p>æ¯ä¸ªå†…å­˜åŒºåŸŸåˆ†æˆå¤šä¸ªç‰©ç†é¡µé¢ï¼›</p>
</li>
<li>
<p>ä¼™ä¼´ç³»ç»Ÿå°†å¤šä¸ªè¿ç»­çš„é¡µé¢ä½œä¸ºä¸€ä¸ªå¤§çš„å†…å­˜å—åˆ†é…ç»™ä¸Šå±‚ï¼›</p>
</li>
<li>
<p>kswapdè´Ÿè´£ç‰©ç†é¡µé¢çš„æ¢å…¥æ¢å‡ºï¼›</p>
</li>
<li>
<p>Slub Allocatorå°†ä»ä¼™ä¼´ç³»ç»Ÿç”³è¯·çš„å¤§å†…å­˜å—åˆ‡æˆå°å—ï¼Œåˆ†é…ç»™å…¶ä»–ç³»ç»Ÿã€‚</p>
</li>
</ul><p><img src="https://static001.geekbang.org/resource/image/52/54/527e5c861fd06c6eb61a761e4214ba54.jpeg?wh=2368*1693" alt=""></p><h2>è¯¾å ‚ç»ƒä¹ </h2><p>å†…å­˜çš„æ¢å…¥å’Œæ¢å‡ºæ¶‰åŠswapåˆ†åŒºï¼Œé‚£ä½ çŸ¥é“å¦‚ä½•æ£€æŸ¥å½“å‰swapåˆ†åŒºæƒ…å†µï¼Œå¦‚ä½•å¯ç”¨å’Œå…³é—­swapåŒºåŸŸï¼Œå¦‚ä½•è°ƒæ•´swappinesså—ï¼Ÿ</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„ç–‘æƒ‘å’Œè§è§£ï¼Œä¹Ÿæ¬¢è¿ä½ æ”¶è—æœ¬èŠ‚å†…å®¹ï¼Œåå¤ç ”è¯»ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œå’Œä»–ä¸€èµ·å­¦ä¹ ã€è¿›æ­¥ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/8c/37/8c0a95fa07a8b9a1abfd394479bdd637.jpg?wh=1110*659" alt=""></p>
<style>
    ul {
      list-style: none;
      display: block;
      list-style-type: disc;
      margin-block-start: 1em;
      margin-block-end: 1em;
      margin-inline-start: 0px;
      margin-inline-end: 0px;
      padding-inline-start: 40px;
    }
    li {
      display: list-item;
      text-align: -webkit-match-parent;
    }
    ._2sjJGcOH_0 {
      list-style-position: inside;
      width: 100%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      margin-top: 26px;
      border-bottom: 1px solid rgba(233,233,233,0.6);
    }
    ._2sjJGcOH_0 ._3FLYR4bF_0 {
      width: 34px;
      height: 34px;
      -ms-flex-negative: 0;
      flex-shrink: 0;
      border-radius: 50%;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 {
      margin-left: 0.5rem;
      -webkit-box-flex: 1;
      -ms-flex-positive: 1;
      flex-grow: 1;
      padding-bottom: 20px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0 {
      font-size: 16px;
      color: #3d464d;
      font-weight: 500;
      -webkit-font-smoothing: antialiased;
      line-height: 34px;
    }
    ._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0 {
      margin-top: 12px;
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-all;
      line-height: 24px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 {
      margin-top: 18px;
      border-radius: 4px;
      background-color: #f6f7fb;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0 {
      color: #505050;
      -webkit-font-smoothing: antialiased;
      font-size: 14px;
      font-weight: 400;
      white-space: normal;
      word-break: break-word;
      padding: 20px 20px 20px 24px;
    }
    ._2sjJGcOH_0 ._3klNVc4Z_0 {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-orient: horizontal;
      -webkit-box-direction: normal;
      -ms-flex-direction: row;
      flex-direction: row;
      -webkit-box-pack: justify;
      -ms-flex-pack: justify;
      justify-content: space-between;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      margin-top: 15px;
    }
    ._2sjJGcOH_0 ._3Hkula0k_0 {
      color: #b2b2b2;
      font-size: 14px;
    }
</style><ul><li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/74/c9/d3439ca4.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>why</span>
  </div>
  <div class="_2_QraFYR_0">- å°å†…å­˜åˆ†é…, ä¾‹å¦‚åˆ†é… task_struct å¯¹è±¡<br>    - ä¼šè°ƒç”¨ kmem_cache_alloc_node å‡½æ•°, ä» task_struct ç¼“å­˜åŒºåŸŸ task_struct_cachep(åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶, ç”± kmem_cache_create åˆ›å»º) åˆ†é…ä¸€å—å†…å­˜<br>    - ä½¿ç”¨ task_struct å®Œæ¯•å, è°ƒç”¨ kmem_cache_free å›æ”¶åˆ°ç¼“å­˜æ± ä¸­<br>    - struct kmem_cache ç”¨äºè¡¨ç¤ºç¼“å­˜åŒºä¿¡æ¯, ç¼“å­˜åŒºå³åˆ†é…è¿ç»­å‡ ä¸ªé¡µçš„å¤§å—å†…å­˜, å†åˆ‡æˆå°å†…å­˜<br>    - å°å†…å­˜å³ç¼“å­˜åŒºçš„æ¯ä¸€é¡¹, éƒ½ç”±å¯¹è±¡å’ŒæŒ‡å‘ä¸‹ä¸€é¡¹ç©ºé—²å°å†…å­˜çš„æŒ‡é’ˆç»„æˆ(éšæœºæ’å…¥&#47;åˆ é™¤+å¿«é€ŸæŸ¥æ‰¾ç©ºé—²)<br>    - struct kmem_cache ä¸­ä¸‰ä¸ª kmem_cache_order_objects è¡¨ç¤ºä¸åŒçš„éœ€è¦åˆ†é…çš„å†…å­˜å—å¤§å°çš„é˜¶æ•°å’Œå¯¹è±¡æ•°<br>    - åˆ†é…ç¼“å­˜çš„å°å†…å­˜å—ç”±ä¸¤ä¸ªè·¯å¾„ fast path å’Œ slow path , åˆ†åˆ«å¯¹åº” struct kmem_cache ä¸­çš„ kmem_cache_cpu å’Œ kmem_cache_node<br>    - åˆ†é…æ—¶å…ˆä» kmem_cache_cpu åˆ†é…, è‹¥å…¶æ— ç©ºé—², å†ä» kmem_cache_node åˆ†é…, è¿˜æ²¡æœ‰å°±ä»ä¼™ä¼´ç³»ç»Ÿç”³è¯·æ–°å†…å­˜å—<br>    - struct kmem_cache_cpu ä¸­<br>        - page æŒ‡å‘å¤§å†…å­˜å—çš„ç¬¬ä¸€ä¸ªé¡µ<br>        - freelist æŒ‡å‘å¤§å†…å­˜å—ä¸­ç¬¬ä¸€ä¸ªç©ºé—²é¡¹<br>        - partial æŒ‡å‘å¦ä¸€ä¸ªå¤§å†…å­˜å—çš„ç¬¬ä¸€ä¸ªé¡µ, ä½†è¯¥å†…å­˜å—æœ‰éƒ¨åˆ†å·²åˆ†é…å‡ºå», å½“ page æ»¡å, åœ¨ partial ä¸­æ‰¾<br>    - struct kmem_cache_node<br>        - ä¹Ÿæœ‰ partial, æ˜¯ä¸€ä¸ªé“¾è¡¨, å­˜æ”¾éƒ¨åˆ†ç©ºé—²çš„å¤šä¸ªå¤§å†…å­˜å—, è‹¥ kmem_cacche_cpu ä¸­çš„ partial ä¹Ÿæ— ç©ºé—², åˆ™åœ¨è¿™æ‰¾<br>    - åˆ†é…è¿‡ç¨‹<br>        - kmem_cache_alloc_node-&gt;slab_alloc_node<br>        - å¿«é€Ÿé€šé“, å–å‡º kmem_cache_cpu çš„ freelist , è‹¥æœ‰ç©ºé—²ç›´æ¥è¿”å›<br>        - æ™®é€šé€šé“, è‹¥ freelist æ— ç©ºé—², è°ƒç”¨ `__slab_alloc`<br>        - `__slab_alloc` ä¼šé‡æ–°æŸ¥çœ‹ freelist, è‹¥è¿˜ä¸æ»¡è¶³, æŸ¥çœ‹ kmem_cache_cpu çš„ partial <br>        - è‹¥ partial ä¸ä¸ºç©º, ç”¨å…¶æ›¿æ¢ page, å¹¶é‡æ–°æ£€æŸ¥æ˜¯å¦æœ‰ç©ºé—²<br>        - è‹¥è¿˜æ˜¯æ— ç©ºé—², è°ƒç”¨ new_slab_objects<br>        - new_slab_objects æ ¹æ®èŠ‚ç‚¹ id æ‰¾åˆ°å¯¹åº” kmem_cache_node , è°ƒç”¨ get_partial_node<br>        - é¦–å…ˆä» kmem_cache_node çš„ partial é“¾è¡¨æ‹¿ä¸‹ä¸€å¤§å—å†…å­˜, æ›¿æ¢ kmem_cache_cpu çš„ page, å†å–ä¸€å—æ›¿æ¢ kmem_cache_cpu çš„ partial<br>        - è‹¥ kmem_cache_node ä¹Ÿæ²¡æœ‰ç©ºé—², åˆ™åœ¨ new_slab_objects ä¸­è°ƒç”¨ new_slab-&gt;allocate_slab-&gt;alloc_slab_page æ ¹æ®æŸä¸ª kmem_cache_order_objects è®¾ç½®ç”³è¯·å¤§å—å†…å­˜<br>- é¡µé¢æ¢å‡º<br>    - è§¦å‘æ¢å‡º: <br>    - 1) åˆ†é…å†…å­˜æ—¶å‘ç°æ²¡æœ‰ç©ºé—²; è°ƒç”¨ `get_page_from_freelist-&gt;node_reclaim-&gt;__node_reclaim-&gt;shrink_node`<br>    - 2) å†…å­˜ç®¡ç†ä¸»åŠ¨æ¢å‡º, ç”±å†…æ ¸çº¿ç¨‹ kswapd å®ç°<br>    - kswapd åœ¨å†…å­˜ä¸ç´§å¼ æ—¶ä¼‘çœ , åœ¨å†…å­˜ç´§å¼ æ—¶æ£€æµ‹å†…å­˜ è°ƒç”¨ balance_pgdat-&gt;kswapd_shrink_node-&gt;shrink_node<br>    - é¡µé¢éƒ½æŒ‚åœ¨ lru é“¾è¡¨ä¸­, é¡µé¢æœ‰ä¸¤ç§ç±»å‹: åŒ¿åé¡µ; æ–‡ä»¶å†…å­˜æ˜ å°„é¡µ<br>    - æ¯ä¸€ç±»æœ‰ä¸¤ä¸ªåˆ—è¡¨: active å’Œ inactive åˆ—è¡¨<br>    - è¦æ¢å‡ºæ—¶, ä» inactive åˆ—è¡¨ä¸­æ‰¾åˆ°æœ€ä¸æ´»è·ƒçš„é¡µæ¢å‡º<br>    - æ›´æ–°åˆ—è¡¨, shrink_list å…ˆç¼©å‡ active åˆ—è¡¨, å†ç¼©å‡ä¸æ´»è·ƒåˆ—è¡¨<br>    - ç¼©å‡ä¸æ´»è·ƒåˆ—è¡¨æ—¶å¯¹é¡µé¢è¿›è¡Œå›æ”¶:<br>        - åŒ¿åé¡µå›æ”¶: åˆ†é… swap, å°†å†…å­˜ä¹Ÿå†™å…¥æ–‡ä»¶ç³»ç»Ÿ<br>        - æ–‡ä»¶å†…å­˜æ˜ å°„é¡µ: å°†å†…å­˜ä¸­çš„æ–‡ä»¶ä¿®æ”¹å†™å…¥æ–‡ä»¶ä¸­</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-24 18:20:18</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/85/ed/905b052f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è¶…è¶…</span>
  </div>
  <div class="_2_QraFYR_0">1.ç³»ç»Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šä½¿ç”¨SWAPï¼Ÿ<br><br>å®é™…ä¸Šï¼Œå¹¶ä¸æ˜¯ç­‰æ‰€æœ‰çš„ç‰©ç†å†…å­˜éƒ½æ¶ˆè€—å®Œæ¯•ä¹‹åï¼Œæ‰å»ä½¿ç”¨swapçš„ç©ºé—´ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ˜¯ç”±swappiness å‚æ•°å€¼æ§åˆ¶ã€‚<br>[root@rhce ~]# catÂ &#47;proc&#47;sys&#47;vm&#47;swappiness<br><br>60<br>è¯¥å€¼é»˜è®¤å€¼æ˜¯60.<br><br>swappiness=0çš„æ—¶å€™è¡¨ç¤ºæœ€å¤§é™åº¦ä½¿ç”¨ç‰©ç†å†…å­˜ï¼Œç„¶åæ‰æ˜¯ swapç©ºé—´ï¼Œ<br><br>swappinessï¼100çš„æ—¶å€™è¡¨ç¤ºç§¯æçš„ä½¿ç”¨swapåˆ†åŒºï¼Œå¹¶ä¸”æŠŠå†…å­˜ä¸Šçš„æ•°æ®åŠæ—¶çš„æ¬è¿åˆ°swapç©ºé—´é‡Œé¢ã€‚<br><br>ç°åœ¨æœåŠ¡å™¨çš„å†…å­˜åŠ¨ä¸åŠ¨å°±æ˜¯ä¸Šç™¾Gï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå‚æ•°å€¼è®¾ç½®çš„ä½ä¸€äº›ï¼Œè®©æ“ä½œç³»ç»Ÿå°½å¯èƒ½çš„ä½¿ç”¨ç‰©ç†å†…å­˜ï¼Œé™ä½ç³»ç»Ÿå¯¹swapçš„ä½¿ç”¨ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚<br><br></div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-07-17 08:11:51</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/15/b4/f6/735673f7.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>W.jyao</span>
  </div>
  <div class="_2_QraFYR_0">çœŸå¿ƒçœ‹ä¸æ‡‚äº†ï¼ŒğŸ˜”ğŸ˜”ğŸ˜”</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¤šçœ‹å‡ éå°±å¥½äº†</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-22 08:45:22</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/11/6e/28/1e307312.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>é²å‹ƒ</span>
  </div>
  <div class="_2_QraFYR_0">æœç„¶å’Œä½ çš„ç½‘ç»œè¯¾ç¨‹ä¸€æ ·ï¼Œè¶Šåˆ°åé¢è¶Šholdä¸ä½ğŸ˜‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å…¶å®å“ªé—¨è¯¾éƒ½ä¸€æ ·å“ˆ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-22 22:45:04</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/85/ed/905b052f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è¶…è¶…</span>
  </div>
  <div class="_2_QraFYR_0">2. å¦‚ä½•ä¿®æ”¹swappinesså‚æ•°ï¼Ÿ<br><br>--ä¸´æ—¶æ€§ä¿®æ”¹ï¼š<br><br>[root@rhce ~]# sysctl vm.swappiness=10<br><br>vm.swappiness = 10<br><br>[root@rhce ~]# cat &#47;proc&#47;sys&#47;vm&#47;swappiness<br>10<br>è¿™é‡Œæˆ‘ä»¬çš„ä¿®æ”¹å·²ç»ç”Ÿæ•ˆï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬é‡å¯äº†ç³»ç»Ÿï¼Œåˆä¼šå˜æˆ60.<br><br>--æ°¸ä¹…ä¿®æ”¹ï¼š<br>åœ¨&#47;etc&#47;sysctl.conf æ–‡ä»¶é‡Œæ·»åŠ å¦‚ä¸‹å‚æ•°ï¼š<br>vm.swappiness=10<br>æˆ–è€…ï¼š<br>[root@rhce ~]# echo &#39;vm.swappiness=10&#39; &gt;&gt;&#47;etc&#47;sysctl.conf<br><br>ä¿å­˜ï¼Œé‡å¯ï¼Œå°±ç”Ÿæ•ˆäº†ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¦‚æ­¤è®¤çœŸï¼Œå…¸èŒƒå•Š</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-07-17 08:13:00</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c5/e6/50c5b805.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ¬ å€ºå¤ªå¤š</span>
  </div>
  <div class="_2_QraFYR_0">çœ‹åˆ°ç°åœ¨ï¼Œä»£ç è¶Šæ¥è¶Šå¤šï¼Œå…³äºä»£ç çš„é˜…è¯»éœ€è¦ä¹ˆï¼Ÿæ€ä¹ˆå»åšå‘¢</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: é‡ç‚¹å…³æ³¨æµç¨‹ï¼Œä¸å…³æ³¨ç»†èŠ‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-22 08:15:30</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/e7/2e/1522a7d6.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ´»çš„æ½‡æ´’</span>
  </div>
  <div class="_2_QraFYR_0">èŠ±äº†4ä¸ªå¤šå°æ—¶ç»ˆäºæŠŠç¬”è®°åšå®Œ<br>åˆ†äº«ç»™å¤§å®¶ï¼š<br>https:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;10907734.html</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-22 19:58:26</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/cd/5c/e09eac13.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>åˆ˜å¼·</span>
  </div>
  <div class="_2_QraFYR_0">è¿™å‡ èŠ‚çœ‹èµ·æ¥åƒåŠ›äº†ï¼Œéœ€è¦ç†è§£çš„å¤–å›´çŸ¥è¯†å¾ˆå¤šï¼</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: åŠ æ²¹ï¼Œå¤šçœ‹å‡ é</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-22 00:49:50</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/85/ed/905b052f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è¶…è¶…</span>
  </div>
  <div class="_2_QraFYR_0">3. å¦‚ä½•æŸ¥çœ‹swapåˆ†åŒº<br>swapon -s<br>cat &#47;proc&#47;swaps<br>free<br>vmstat<br>ä»¥ä¸Š4ç±»å‘½ä»¤éƒ½å¯ä»¥æŸ¥çœ‹swapåˆ†åŒºçš„å¤§å°å’Œä½¿ç”¨æƒ…å†µ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-07-17 08:18:01</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/90/71/e961e311.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>guojiun</span>
  </div>
  <div class="_2_QraFYR_0">https:&#47;&#47;events.static.linuxfound.org&#47;sites&#47;events&#47;files&#47;slides&#47;slaballocators.pdf é€™è£¡æœ‰æ¸…æ¥šçš„è¦–æ„åœ–ï¼Œå°ç…§è‘—çœ‹æœƒæ›´æ¸…æ¥šï¼</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-22 09:00:18</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/1a/51/b8/f76b15a1.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>sundy</span>
  </div>
  <div class="_2_QraFYR_0">çœŸçš„åº”è¯¥å°‘ç²˜ä»£ç  å¤šè®²åŸç†ã€å¤šæŠ½è±¡ï¼Œä¸ç„¶å¾ˆéš¾å°†æ‚¨è®²çš„ä¸œè¥¿ä¸²è”èµ·æ¥ï¼Œè¿åŸºæœ¬åŸç†éƒ½ä¸äº†è§£ç¡¬ç”Ÿç”Ÿçš„è®²ä»£ç å®åœ¨æ˜¯è®©äººå›°æƒ‘</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å…¶å®æ˜¯æœ‰ä¸€ä¸ªæ•´ä½“æ€è·¯çš„ï¼Œè¢«ä»£ç æ‰“æ–­äº†ï¼Œå¯ä»¥è®²ä»£ç æ€»ç»“ä¸€ä¸ªæ®µè½å¤§æ„ï¼Œç„¶åå†ç©¿èµ·æ¥çœ‹ï¼Œæ˜¯ä¸æ˜¯å¥½ä¸€äº›</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-06-03 19:40:33</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/85/ed/905b052f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>è¶…è¶…</span>
  </div>
  <div class="_2_QraFYR_0">å‚è€ƒæ–‡ç« ï¼šhttps:&#47;&#47;mp.weixin.qq.com&#47;s&#47;6JVpke8bDKI9lvh_l6QF-w</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: èµ</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-07-17 08:21:28</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/17/52/d8/123a4981.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>ç»¿ç®­ä¾ </span>
  </div>
  <div class="_2_QraFYR_0">è¿™ä¸ªä¸“æ æœ€å¤§çš„å¥½å¤„å°±æ˜¯èƒ½å°†é‚£äº›ä¸“ä¸šçš„åšçš„ä¹¦ç±çš„å®½æ³›çŸ¥è¯†ç‚¹ä¸²èµ·æ¥ï¼Œèƒ½å¸®åŠ©æ·±å…¥ç†è§£ï¼ï¼ï¼</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-02-22 12:24:00</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/59/f6/ed66d1c1.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>chengzise</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆå¥½ï¼Œè¿™ä¸¤èŠ‚è®²çš„æ˜¯ç‰©ç†å†…å­˜çš„ç®¡ç†å’Œåˆ†é…ï¼Œå¤§æ¦‚é€»è¾‘æ˜¯çœ‹çš„æ‡‚çš„ï¼Œç»†èŠ‚éœ€è¦ç»§ç»­åå¤ç ”è¯»æ‰è¡Œã€‚å…¶ä¸­æœ‰ä¸ªé—®é¢˜ï¼Œkmem_cacheéƒ¨åˆ†å·²ç»å±äºé¡µå†…å°å†…å­˜åˆ†é…ï¼Œè¿™ä¸ªåˆ†é…ç®—æ³•å±äºè™šæ‹Ÿå†…å­˜åˆ†é…ï¼Œä¸ç®—ç‰©ç†å†…å­˜ç®¡ç†èŒƒç•´å§ï¼Ÿ å°±æ˜¯è¯´å…ˆåˆ†é…ç‰©ç†å†…å­˜é¡µï¼Œæ˜ å°„åˆ°è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œå†åœ¨è¿™ä¸ªè™šæ‹Ÿå†…å­˜åˆ†é…å°å†…å­˜ç»™ç¨‹åºé€»è¾‘ä½¿ç”¨ã€‚å¸Œæœ›è€å¸ˆè§£ç­”ä¸€ä¸‹ã€‚</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: æ˜¯çš„ï¼Œä¼šæ˜ å°„æˆä¸ºè™šæ‹Ÿåœ°å€ï¼Œæ˜¯æ•´é¡µä¼šæœ‰è™šæ‹Ÿåœ°å€</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-05-23 07:23:53</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/19/7c/bb/635a2710.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å¾å°‘æ–‡</span>
  </div>
  <div class="_2_QraFYR_0">çœ‹åˆ°è¿™é‡Œéå¸¸æœ‰ä¸€ç§çœ‹Windowså†…æ ¸åŸç†ä¸å®ç°çš„æ„Ÿå—äº†ï¼Œå°±æ˜¯æ„Ÿè§‰ç»å¸¸æ‘†å‡ºä¸€å¤§å †æ•°æ®ç»“æ„ï¼Œçœ‹çš„å¤ªç—›è‹¦äº†ã€‚æ‰“ç®—è®°å¥½ç¬”è®°ç„¶åæ¯å¤©æ‰“å¼€çœ‹ä¸€çœ‹ã€‚</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2021-03-04 14:03:17</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/12/a6/43/cb6ab349.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>Spring</span>
  </div>
  <div class="_2_QraFYR_0">æœ‰äº†å¿«é€Ÿé€šé“ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦æ™®é€šé€šé“ï¼Œè¿™ä¸€ç‚¹æä¸æ˜ç™½</div>
  <div class="_10o3OAxT_0">
    
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-07-26 10:39:39</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/10/13/71/3762b089.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>stevensafin</span>
  </div>
  <div class="_2_QraFYR_0">å¯¹äºslabåˆ†é…å†…å­˜çš„æœºåˆ¶ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç”¨ä¸ªæµç¨‹å›¾æ¥è¡¨ç¤ºä¼šæ›´å¥½ä¸€ç‚¹ï¼Ÿè¿˜æœ‰å°±æ˜¯å¿«æ…¢é€šé“çš„é€Ÿåº¦å·®è·å’Œå…·ä½“è®¾è®¡åŸå› èƒ½ä¸èƒ½è¯´æ˜ä¸€ä¸‹ï¼Œæ„Ÿè°¢è€å¸ˆ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å…¶å®é€šè¿‡é‡Œé¢çš„å›¾ï¼ŒåŸºæœ¬èƒ½å¤Ÿç†è§£æ•´ä¸ªæµç¨‹ã€‚å¤§æ¦‚çš„æ€æƒ³å’Œå’±ä»¬é€šè¿‡å¤šçº§ç¼“å­˜åŠ é€Ÿæ•°æ®åº“è®¿é—®å·®ä¸å¤šï¼Œä¸€çº§æ‰¾ä¸åˆ°æ‰¾äºŒçº§ï¼ŒäºŒçº§æ‰¾ä¸åˆ°æ‰¾æ•°æ®åº“ã€‚</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2020-06-05 16:59:52</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/18/90/8f/9c691a5f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å¥”è·‘çš„ç ä»”</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œslubå­˜åœ¨å›æ”¶æœºåˆ¶å§ï¼Ÿå°±æ˜¯slubä¸­ç©ºé—²å¾ˆå¤šçš„æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯ä¼šè¿™äº›å†…å­˜å—é‡Šæ”¾ï¼Œè¿”å›ç»™ç³»ç»Ÿå‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä¸€ä¸ªå†…å­˜å—çš„slubå…¨éƒ¨é‡Šæ”¾ä¹‹åï¼Œæ•´ä¸ªé¡µéƒ½ä¼šå›æ”¶</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-29 17:36:32</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/18/90/8f/9c691a5f.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>å¥”è·‘çš„ç ä»”</span>
  </div>
  <div class="_2_QraFYR_0">è€å¸ˆï¼Œkmem_cache_cpuä¸­çš„pageå’Œpartialä¸æ˜¯æŒ‡å‘åŒä¸€å—å†…å­˜åŒºåŸŸçš„å§ï¼Œä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆè®¾è®¡å‘¢ï¼Ÿpartialçš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: ä¸æ˜¯åŒä¸€å—çš„ã€‚å¤‡ç”¨åˆ—è¡¨ï¼Œå½“ page æ»¡äº†ï¼Œå°±ä¼šä»è¿™é‡Œæ‰¾<br></p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-08-29 16:59:29</div>
  </div>
</div>
</div>
</li>
<li>
<div class="_2sjJGcOH_0"><img src="https://static001.geekbang.org/account/avatar/00/16/91/d0/35bc62b1.jpg"
  class="_3FLYR4bF_0">
<div class="_36ChpWj4_0">
  <div class="_2zFoi7sd_0"><span>æ— å’</span>
  </div>
  <div class="_2_QraFYR_0">kswapd åœ¨å†…å­˜ç´§å¼ çš„æ—¶å€™ï¼Œå¼€å§‹å·¥ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªç´§å¼ çš„æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ€»çš„ç‰©ç†å†…å­˜è¿˜æ˜¯æŒ‰ç…§ zone æ¥åŒºåˆ†å‘¢ï¼Ÿ</div>
  <div class="_10o3OAxT_0">
    <p class="_3KxQPN3V_0">ä½œè€…å›å¤: å¯¹æ¯ä¸ªNUMAç»“ç‚¹æ¥è¯´ï¼Œéƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„kswapdå®ˆæŠ¤è¿›ç¨‹</p>
  </div>
  <div class="_3klNVc4Z_0">
    <div class="_3Hkula0k_0">2019-07-10 18:02:57</div>
  </div>
</div>
</div>
</li>
</ul>